<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Immersive Tense Magic | AAQI Soft Solutions</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;700;900&display=swap');

        * { box-sizing: border-box; font-family: 'Poppins', sans-serif; transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1); }

        body {
            margin: 0; padding: 0;
            min-height: 100vh;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            background-color: #2c3e50; 
            overflow: hidden;
            color: white;
        }

        /* Background States */
        .bg-past { background-color: #6c5ce7; }
        .bg-present { background-color: #00cec9; }
        .bg-future { background-color: #fdcb6e; }

        .content-wrap {
            width: 90%; max-width: 800px;
            text-align: center;
            z-index: 10;
        }

        h1 { font-size: 2.8rem; font-weight: 900; margin-bottom: 5px; text-shadow: 0 5px 20px rgba(0,0,0,0.1); }

        textarea {
            width: 100%; background: transparent; border: none;
            outline: none; color: white; font-size: 1.5rem;
            text-align: center; font-weight: 600;
            padding: 15px; resize: none;
        }

        textarea::placeholder { color: rgba(255,255,255,0.3); }

        .info-panel {
            margin-top: 20px;
            opacity: 0; transform: translateY(20px);
            display: flex; flex-direction: column; align-items: center;
        }

        .info-panel.visible { opacity: 1; transform: translateY(0); }

        .tense-name {
            display: inline-block; padding: 5px 15px;
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            border-radius: 50px; font-weight: 800;
            font-size: 1rem; text-transform: uppercase;
            margin-bottom: 15px;
        }

        /* Fixed Description Area with Scroll */
        .scroll-container {
            width: 100%; max-width: 500px;
            height: 120px;
            overflow-y: auto;
            padding: 5px;
            text-align: left;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .scroll-container::-webkit-scrollbar { width: 3px; }
        .scroll-container::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); }

        .desc-text { font-size: 12px; line-height: 1.5; margin-bottom: 8px; }
        .error-text { color: #ffeb3b; font-weight: bold; font-size: 12px; margin-bottom: 8px; display: block; }
        
        .related-title { font-weight: 700; font-size: 10px; text-transform: uppercase; opacity: 0.7; margin-top: 10px; }
        .related-item { font-size: 11px; opacity: 0.9; margin-bottom: 3px; font-style: italic; }

        .voice-link {
            background: none; border: none; color: white;
            text-decoration: underline; font-size: 11px;
            cursor: pointer; opacity: 0.8; margin-top: 10px;
        }

        .footer { position: absolute; bottom: 20px; font-weight: 700; opacity: 0.5; font-size: 0.8rem; }
    </style>
</head>
<body id="main-body">

    <div class="content-wrap">
        <h1>Tense Magic</h1>
        <textarea id="typing-area" placeholder="Try: I am reading a book..." oninput="magicDetect()" autofocus></textarea>

        <div id="info-panel" class="info-panel">
            <div class="tense-name" id="tense-display">Checking...</div>
            
            <div class="scroll-container">
                <div class="desc-text" id="explanation-text"></div>
                <div class="error-text" id="error-display"></div>
                <div id="related-section">
                    <div class="related-title">See in other tenses:</div>
                    <div id="related-list"></div>
                </div>
            </div>

            <button class="voice-link" onclick="speak()">Click to Hear Explanation</button>
        </div>
    </div>

    <div class="footer">AAQI Soft Solutions</div>

<script>
    const body = document.getElementById('main-body');
    const panel = document.getElementById('info-panel');
    const tenseName = document.getElementById('tense-display');
    const explanation = document.getElementById('explanation-text');
    const errorDisplay = document.getElementById('error-display');
    const relatedList = document.getElementById('related-list');
    const synth = window.speechSynthesis;

    function magicDetect() {
        const text = document.getElementById('typing-area').value.trim();
        const lowerText = text.toLowerCase();
        
        if (text.length < 3) {
            panel.classList.remove('visible');
            body.className = ''; 
            return;
        }

        panel.classList.add('visible');
        let currentTense = "Present";
        let title = "Simple Present";
        let desc = "Describes a general fact or a daily habit.";
        let errorMsg = "";

        // --- Detection Logic ---
        if (lowerText.includes("will ") || lowerText.includes("shall ")) {
            currentTense = "Future";
            title = "Simple Future";
            desc = "Describes an action that hasn't happened yet.";
        } 
        else if (lowerText.match(/(was|were|did|went|ate|walked|had|played|saw)/) || lowerText.match(/\w+ed\s/)) {
            currentTense = "Past";
            title = "Simple Past";
            desc = "Refers to a completed action in the past.";
        }

        if (lowerText.includes("ing") && lowerText.match(/(is|am|are|was|were|will be)/)) {
            title = title.replace("Simple", "") + " Continuous";
            desc = "Indicates an action currently in progress or continuing.";
        }

        // --- Basic Error Logic ---
        if (lowerText.match(/\b(he|she|it)\s(go|eat|play|walk|do)\b/)) {
            errorMsg = "⚠️ Hint: Use 'goes', 'eats', or 'plays' with He/She/It.";
        }
        if (lowerText.includes("i is") || lowerText.includes("i are")) {
            errorMsg = "⚠️ Hint: Use 'I am' instead of 'I is/are'.";
        }

        // --- Related Tenses Generator ---
        generateRelated(text, currentTense);

        // Apply changes
        tenseName.innerText = title;
        explanation.innerText = desc;
        errorDisplay.innerText = errorMsg;
        body.className = 'bg-' + currentTense.toLowerCase();
    }

    function generateRelated(input, current) {
        relatedList.innerHTML = "";
        let variations = [];
        
        // Simple logic to suggest variations based on "I" or "He/She"
        if (current === "Present") {
            variations.push(`Past: It would be like "I played" or "I was playing"`);
            variations.push(`Future: It would be like "I will play"`);
        } else if (current === "Past") {
            variations.push(`Present: Try saying "I play" or "I am playing"`);
            variations.push(`Future: Try saying "I will play"`);
        } else {
            variations.push(`Present: Try "I play" or "I am playing"`);
            variations.push(`Past: Try "I played" or "I was playing"`);
        }

        variations.forEach(v => {
            const div = document.createElement('div');
            div.className = "related-item";
            div.innerText = v;
            relatedList.appendChild(div);
        });
    }

    function speak() {
        const msg = `${tenseName.innerText}. ${explanation.innerText}. ${errorDisplay.innerText}`;
        const utterance = new SpeechSynthesisUtterance(msg);
        utterance.pitch = 1.3;
        synth.speak(utterance);
    }
</script>
</body>
</html>
